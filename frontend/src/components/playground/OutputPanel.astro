---
import Icon from '../Icon.astro';
---

<div class="output-panel">
  <div class="panel-header">
    <span class="panel-title">Output</span>
    <div class="panel-actions">
      <button id="toggle-output-max" class="icon-btn-sm" title="Maximizar Output">
        <span class="icon-maximize"><Icon name="maximize" size={14} /></span>
        <span class="icon-minimize" style="display: none;"><Icon name="minimize" size={14} /></span>
      </button>
      <div style="width: 1px; height: 16px; background: var(--border-subtle); margin: 0 4px;"></div>
      <button id="clear-output-btn" class="btn-secondary btn-sm" title="Limpar Output">
        <Icon name="trash-2" size={14} />
        <span>Limpar</span>
      </button>
    </div>
  </div>
  
  <div class="output-container">
    <div id="output" class="output-content">
      <div class="output-welcome">
        <Icon name="terminal" size={24} />
        <p>Escreva seu código C e clique em <strong>Executar</strong></p>
        <span class="hint">Ctrl+Enter para executar • Suporte a múltiplos arquivos</span>
      </div>
    </div>
    
    <div class="input-section" id="stdin-section" style="display: none;">
      <label for="stdin-input">Entrada (stdin):</label>
      <textarea id="stdin-input" placeholder="Dados de entrada..."></textarea>
    </div>
  </div>
  
  <div class="execution-stats" id="execution-stats" style="display: none;">
    <div class="stat">
      <Icon name="clock" size={12} />
      <span id="exec-time">0ms</span>
    </div>
    <div class="stat">
      <Icon name="file-code" size={12} />
      <span id="exec-files">0 arquivos</span>
    </div>
  </div>
</div>

<style>
  .output-panel {
    flex: 0 0 35%; /* Default width */
    min-width: 250px;
    max-width: 80%;
    display: flex;
    flex-direction: column;
    background: #0D0D0D; /* VS Code Terminal bg */
    border-left: 1px solid var(--border-subtle);
  }

  .panel-header {
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 16px;
    background: var(--bg-panel);
    border-bottom: 1px solid var(--border-subtle);
    border-bottom: 1px solid var(--border-subtle);
    flex-shrink: 0;
  }

  .panel-actions {
    display: flex;
    align-items: center;
    gap: 4px;
  }

  .icon-btn-sm {
    width: 24px; height: 24px; display: flex; align-items: center; justify-content: center;
    background: transparent; border: none; border-radius: 4px;
    color: var(--text-muted); cursor: pointer; transition: 0.2s;
  }
  .icon-btn-sm:hover { color: var(--text-primary); background: var(--bg-subtle); }

  .panel-title {
    font-size: 11px;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .output-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    position: relative;
  }

  .output-content {
    flex: 1;
    padding: 16px;
    overflow-y: auto;
    font-family: var(--font-code);
    font-size: 13px;
    line-height: 1.5;
    color: #cccccc;
    white-space: pre-wrap;
    word-break: break-all;
  }

  .output-welcome {
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    text-align: center;
    gap: 12px;
    opacity: 0.6;
  }

  .output-welcome p { font-size: 14px; font-weight: 500; }
  .output-welcome .hint { font-size: 12px; opacity: 0.7; }

  .input-section {
    padding: 12px;
    background: var(--bg-subtle);
    border-top: 1px solid var(--border-subtle);
  }

  .input-section label {
    display: block;
    font-size: 11px;
    color: var(--text-muted);
    margin-bottom: 6px;
    font-weight: 500;
  }

  .input-section textarea {
    width: 100%;
    height: 60px;
    background: rgba(0,0,0,0.2);
    border: 1px solid var(--border-subtle);
    border-radius: 4px;
    color: var(--text-primary);
    padding: 8px;
    font-family: var(--font-code);
    font-size: 12px;
    resize: none;
  }

  .input-section textarea:focus {
    border-color: var(--border-prominent);
  }

  .execution-stats {
    height: 28px;
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 0 16px;
    background: var(--bg-subtle);
    border-top: 1px solid var(--border-subtle);
    font-size: 11px;
    color: var(--text-muted);
  }

  .stat { display: flex; align-items: center; gap: 6px; }

  /* Utilities */
  .btn-secondary {
    display: flex;
    align-items: center;
    gap: 8px;
    height: 32px;
    padding: 0 12px;
    background: transparent;
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-sm);
    color: var(--text-secondary);
    font-size: 13px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
  }

  .btn-secondary:hover {
    border-color: var(--border-prominent);
    color: var(--text-primary);
    background: var(--bg-subtle);
  }

  .btn-sm { height: 24px; padding: 0 8px; font-size: 11px; }

  /* Dynamic Output Styles */
  :global(.output-section) {
    margin-bottom: 16px;
    border-radius: 6px;
    overflow: hidden;
    background: rgba(255,255,255,0.02);
  }

  :global(.output-section.error) {
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid rgba(239, 68, 68, 0.2);
  }

  :global(.output-section.success) {
    background: rgba(16, 185, 129, 0.1);
    border: 1px solid rgba(16, 185, 129, 0.2);
  }

  :global(.output-section.info) {
    background: rgba(59, 130, 246, 0.1);
    border: 1px solid rgba(59, 130, 246, 0.2);
  }

  :global(.section-header) {
    padding: 6px 12px;
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    background: rgba(0,0,0,0.2);
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  :global(.output-section.error .section-header) { color: #fca5a5; }
  :global(.output-section.success .section-header) { color: #6ee7b7; }

  :global(.output-section pre) {
    margin: 0;
    padding: 12px;
    overflow-x: auto;
    font-family: 'JetBrains Mono', monospace;
  }

</style>
